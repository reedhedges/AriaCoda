<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AriaCoda: teleopActionsExample.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AriaCoda
   &#160;<span id="projectnumber">cdf8a12May11,2021</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('teleopActionsExample_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">teleopActionsExample.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Example using actions for safe teleoperation with keyboard or joystick.This example program creates several "limiting" actions (stop the robot from hitting detected obstacles), as well as Joydrive and Keydrive actions which request movement based on keys pressed or a joystick attached to the computer. The limiting actions are added at a higher priority than the teleoperation actions, so they prevent those actions from driving the robot if nearby obstacles are detected; otherwise, you can drive the robot using they joystick or keyboard.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">Adept MobileRobots Robotics Interface for Applications (ARIA)</span></div>
<div class="line"><span class="comment">Copyright (C) 2004-2005 ActivMedia Robotics LLC</span></div>
<div class="line"><span class="comment">Copyright (C) 2006-2010 MobileRobots Inc.</span></div>
<div class="line"><span class="comment">Copyright (C) 2011-2015 Adept Technology, Inc.</span></div>
<div class="line"><span class="comment">Copyright (C) 2016-2018 Omron Adept Technologies, Inc.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">     it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">     the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><span class="comment">     (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">     but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">     GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">     along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">     Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#include &quot;Aria/Aria.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    Aria::init();</div>
<div class="line">    ArArgumentParser parser(&amp;argc, argv);</div>
<div class="line">    parser.loadDefaultArguments();</div>
<div class="line">    ArRobot robot;</div>
<div class="line">    ArRobotConnector robotConnector(&amp;parser, &amp;robot);</div>
<div class="line">    <span class="keywordflow">if</span>(!robotConnector.connectRobot())</div>
<div class="line">    {</div>
<div class="line">      ArLog::log(ArLog::Terse, <span class="stringliteral">&quot;teleopActionsExample: Could not connect to the robot.&quot;</span>);</div>
<div class="line">      <span class="keywordflow">if</span>(parser.checkHelpAndWarnUnparsed())</div>
<div class="line">      {</div>
<div class="line">          Aria::logOptions();</div>
<div class="line">          Aria::exit(1);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!Aria::parseArgs() || !parser.checkHelpAndWarnUnparsed())</div>
<div class="line">    {</div>
<div class="line">      Aria::logOptions();</div>
<div class="line">      Aria::exit(1);</div>
<div class="line">    }</div>
<div class="line">    ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;teleopActionsExample: Connected.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="comment">// limiter for close obstacles</span></div>
<div class="line">  ArActionLimiterForwards limiter(<span class="stringliteral">&quot;speed limiter near&quot;</span>, 300, 600, 250);</div>
<div class="line">  <span class="comment">// limiter for far away obstacles</span></div>
<div class="line">  ArActionLimiterForwards limiterFar(<span class="stringliteral">&quot;speed limiter far&quot;</span>, 300, 1100, 400);</div>
<div class="line">  <span class="comment">// limiter that checks IR sensors (like Peoplebot has)</span></div>
<div class="line">  ArActionLimiterTableSensor tableLimiter;</div>
<div class="line">  <span class="comment">// limiter so we don&#39;t bump things backwards</span></div>
<div class="line">  ArActionLimiterBackwards backwardsLimiter;</div>
<div class="line">  <span class="comment">// the joydrive action</span></div>
<div class="line">  ArActionJoydrive joydriveAct;</div>
<div class="line">  <span class="comment">// the keydrive action</span></div>
<div class="line">  ArActionKeydrive keydriveAct;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// sonar device, used by the limiter actions.</span></div>
<div class="line">  ArSonarDevice sonar;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  printf(<span class="stringliteral">&quot;This program will allow you to use a joystick or keyboard to control the robot.\nYou can use the arrow keys to drive, and the spacebar to stop.\nFor joystick control press the trigger button and then drive.\nPress escape to exit.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// if we don&#39;t have a joystick, let &#39;em know</span></div>
<div class="line">  <span class="keywordflow">if</span> (!joydriveAct.joystickInited())</div>
<div class="line">    printf(<span class="stringliteral">&quot;Do not have a joystick, only the arrow keys on the keyboard will work.\n&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// add the sonar to the robot</span></div>
<div class="line">  robot.addRangeDevice(&amp;sonar);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set the robots maximum velocity (sonar don&#39;t work at all well if you&#39;re</span></div>
<div class="line">  <span class="comment">// going faster)</span></div>
<div class="line">  robot.setAbsoluteMaxTransVel(400);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// enable the motor</span></div>
<div class="line">  robot.enableMotors();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add the actions, with the limiters as highest priority, then the teleop.</span></div>
<div class="line">  <span class="comment">// actions.  This will keep the teleop. actions from being able to drive too </span></div>
<div class="line">  <span class="comment">// fast and hit something</span></div>
<div class="line">  robot.addAction(&amp;tableLimiter, 100);</div>
<div class="line">  robot.addAction(&amp;limiter, 95);</div>
<div class="line">  robot.addAction(&amp;limiterFar, 90);</div>
<div class="line">  robot.addAction(&amp;backwardsLimiter, 85);</div>
<div class="line">  robot.addAction(&amp;joydriveAct, 50);</div>
<div class="line">  robot.addAction(&amp;keydriveAct, 45);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Configure the joydrive action so it will let the lower priority actions</span></div>
<div class="line">  <span class="comment">// (i.e. keydriveAct) request motion if the joystick button is</span></div>
<div class="line">  <span class="comment">// not pressed.</span></div>
<div class="line">  joydriveAct.setStopIfNoButtonPressed(<span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="comment">// run the robot, true means that the run will exit if connection lost</span></div>
<div class="line">  robot.run(<span class="keyword">true</span>);</div>
<div class="line">  </div>
<div class="line">  Aria::exit(0);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
