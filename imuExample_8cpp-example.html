<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AriaCoda: imuExample.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AriaCoda
   &#160;<span id="projectnumber">cdf8a12May11,2021</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('imuExample_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">imuExample.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Example of gathering IMU data from SeekurSample program that demonstrates how to get IMU data from an IMU on <br  />
 a Seekur-class robot (from SeekurOS). Only some Seekurs have IMUs.</p>
<p>[Some Pioneers also have gyros that are integrated into the robot and normally automatically correct data or which can optionally return the data seperately (using different packets and different ARIA interface in ArAnalogGyro).]</p>
<p>The data comes back in a custom packet with ID 0x9A. It's requested with client command 26.</p>
<p>Press escape to exit the program.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">Adept MobileRobots Robotics Interface for Applications (ARIA)</span></div>
<div class="line"><span class="comment">Copyright (C) 2004-2005 ActivMedia Robotics LLC</span></div>
<div class="line"><span class="comment">Copyright (C) 2006-2010 MobileRobots Inc.</span></div>
<div class="line"><span class="comment">Copyright (C) 2011-2015 Adept Technology, Inc.</span></div>
<div class="line"><span class="comment">Copyright (C) 2016-2018 Omron Adept Technologies, Inc.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">     it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">     the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><span class="comment">     (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">     but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">     GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">     along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">     Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#include &quot;Aria/Aria.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Aria/ArSeekurIMU.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Aria/ArRobotConfigPacketReader.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  Aria::init();</div>
<div class="line">  ArArgumentParser parser(&amp;argc, argv);</div>
<div class="line">  parser.loadDefaultArguments();</div>
<div class="line">  ArRobot robot;</div>
<div class="line">  ArSeekurIMU imu(&amp;robot);</div>
<div class="line"> </div>
<div class="line">  ArRobotConnector robotConnector(&amp;parser, &amp;robot);</div>
<div class="line">  <span class="keywordflow">if</span>(!robotConnector.connectRobot())</div>
<div class="line">  {</div>
<div class="line">    ArLog::log(ArLog::Terse, <span class="stringliteral">&quot;imuExample: Could not connect to the robot.&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span>(parser.checkHelpAndWarnUnparsed())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// -help not given</span></div>
<div class="line">        Aria::logOptions();</div>
<div class="line">        Aria::exit(1);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!Aria::parseArgs() || !parser.checkHelpAndWarnUnparsed())</div>
<div class="line">  {</div>
<div class="line">    Aria::logOptions();</div>
<div class="line">    Aria::exit(1);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;imuExample: Connected to robot.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  ArKeyHandler keyHandler;</div>
<div class="line">  Aria::setKeyHandler(&amp;keyHandler);</div>
<div class="line">  robot.attachKeyHandler(&amp;keyHandler);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Run robot cycle in background thread</span></div>
<div class="line">  robot.runAsync(<span class="keyword">true</span>);</div>
<div class="line">  ArUtil::sleep(500);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Check whether robot firmware thinks it has an IMU</span></div>
<div class="line">  robot.lock();</div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">  if (!robot.getOrigRobotConfig()-&gt;getHasGyro())</span></div>
<div class="line"><span class="comment">  {</span></div>
<div class="line"><span class="comment">    ArLog::log(ArLog::Terse, &quot;imuExample: Robot firmware indicates gyro/imu disabled! (See HasGyro and/or GyroType parameter)&quot;);</span></div>
<div class="line"><span class="comment">    robot.unlock();</span></div>
<div class="line"><span class="comment">    Aria::exit(1);</span></div>
<div class="line"><span class="comment">    return 1;</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordtype">int</span> gyroType = robot.getOrigRobotConfig()-&gt;getGyroType();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *gyroTypeDescr = <span class="stringliteral">&quot;UNRECOGNIZED VALUE&quot;</span>;</div>
<div class="line">  <span class="keywordflow">switch</span>(gyroType)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> 0:</div>
<div class="line">      gyroTypeDescr = <span class="stringliteral">&quot;Disabled/No Gyro&quot;</span>;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 1:</div>
<div class="line">      gyroTypeDescr = <span class="stringliteral">&quot;Pioneer3 Gyro Data&quot;</span>;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 2:</div>
<div class="line">      gyroTypeDescr = <span class="stringliteral">&quot;Pioneer3 Gyro Auto&quot;</span>;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 3:</div>
<div class="line">      gyroTypeDescr = <span class="stringliteral">&quot;Seekur/SeekurJr Single Axis Gyro&quot;</span>;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 4:</div>
<div class="line">      gyroTypeDescr = <span class="stringliteral">&quot;Seekur/SeekurJr IMU&quot;</span>;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;imuExample: Unrecognized GyroType value %d!&quot;</span>, gyroType);</div>
<div class="line">  }</div>
<div class="line">  ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;imuExample: Robot firmware reports GyroType=%d (%s)&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span>(gyroType != 4)</div>
<div class="line">  {</div>
<div class="line">    ArLog::log(ArLog::Terse, <span class="stringliteral">&quot;imuExample: Robot firmware configuration paramater GyroType=%d (%s). Cannot get IMU data with this GyroType, need GyroType 4.&quot;</span>, gyroType, gyroTypeDescr);</div>
<div class="line">    robot.unlock();</div>
<div class="line">    Aria::exit(1);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  robot.unlock();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//       x   y   z   ax  ay  az  px  py  pz t</span></div>
<div class="line">  printf(<span class="stringliteral">&quot;%6s %6s %6s %6s %6s %6s %6s %6s %6s %6s\n&quot;</span>, </div>
<div class="line">          <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>, <span class="stringliteral">&quot;ax&quot;</span>, <span class="stringliteral">&quot;ay&quot;</span>, <span class="stringliteral">&quot;az&quot;</span>, <span class="stringliteral">&quot;px&quot;</span>, <span class="stringliteral">&quot;py&quot;</span>, <span class="stringliteral">&quot;pz&quot;</span>, <span class="stringliteral">&quot;t&quot;</span>);</div>
<div class="line">  <span class="keywordflow">while</span> (robot.isConnected())</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">//sholud do this from a SensorInterpTask</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;%4.2f %4.2f %4.2f %4.2f %4.2f %4.2f %4.2f %4.2f %4.2f %4.2f \r&quot;</span>,</div>
<div class="line">      imu.getXSpeed(),</div>
<div class="line">      imu.getYSpeed(),</div>
<div class="line">      imu.getZSpeed(),</div>
<div class="line">      imu.getXAccel(),</div>
<div class="line">      imu.getYAccel(),</div>
<div class="line">      imu.getZAccel(),</div>
<div class="line">      imu.getXPos(),</div>
<div class="line">      imu.getYPos(),</div>
<div class="line">      imu.getZPos(),</div>
<div class="line">      imu.getTemperature()</div>
<div class="line">    );</div>
<div class="line">    ArUtil::sleep(100);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  Aria::exit(0);</div>
<div class="line">}</div>
<div class="line">             </div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
